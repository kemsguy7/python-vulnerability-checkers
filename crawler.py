#!/usr/bin/env python

# This script detects directories automatically on a website
import requests

def request(url):
    try:
        get_response = requests.get("http://" + url)  # This line sends a GET request and returns a response if it fails or not
        print(get_response)
    except requests.exceptions.ConnectionError:
        pass

target_url = "http://192.168.63.131/mutillidae/"  # This file will be run against Mutillidae, a website in Metasploitable VM

wordlist_file = open("subdomains.txt", "r")  # Open the wordlist file for reading
for line in wordlist_file:
    word = line.strip()  # Strips the wordlist file of extra characters
    test_url = word + "/" + target_url  # Directories make use of forward slashes, something like google.com/files, etc.
    response = request(test_url)  # Capture the results by a variable
    if response:
        print("[+] Discovered Subdomain --> " + test_url)

wordlist_file.close()  # Close the wordlist file after processing

