#!/usr/bin/env python

# This script detects directories automatically on a website
import requests

def request(url):
    try:
        get_response = requests.get("http://" + url)  # This line sends a GET request and returns a response if it fails or not
        print(get_response)
    except requests.exceptions.ConnectionError:
        pass

metasploitable_ip = "192.168.63.131"  # Replace with the actual IP address of your Metasploitable VM

with open("subdomains.txt", "r") as wordlist_file:  # This line opens up a wordlist file that will be used to check for directories
    for line in wordlist_file:
        word = line.strip()  # Strips the wordlist file of extra characters
        test_url = word + "/" + metasploitable_ip  # Directories make use of forward slashes, something like google.com/files, etc.
        response = request(test_url)  # Capture the results by a variable
        if response:
            print("[+] Discovered Subdomain --> " + test_url)
